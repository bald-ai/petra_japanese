{% extends "base.html" %}

{% block content %}
  <div class="card">
    <h1>{{ lesson_name }} Practice</h1>
    <p>
      Play the audio, review the Japanese transcript, and use the accompanying image sheet to
      choose the best answer. English translations are tucked away in a collapsible section.
    </p>
  </div>

  {% for item in items %}
    <div class="card">
      <h2>Question {{ loop.index }}</h2>
      <div class="two-column">
        <div>
          {% if item.audio_path %}
            <audio controls preload="none" src="{{ url_for('static', filename=item.audio_path) }}">
              Your browser does not support the audio element.
            </audio>
          {% endif %}
          {% if item.jp %}
            <details>
              <summary>Show Japanese transcript</summary>
              <p>{{ item.jp | replace('\n', '<br>') | safe }}</p>
            </details>
          {% endif %}
          {% if item.en %}
            <details>
              <summary>Show English translation</summary>
              <p>{{ item.en | replace('\n', '<br>') | safe }}</p>
            </details>
          {% endif %}
          <details>
            <summary>Show answer</summary>
            <p>
              {% if item.answer_position %}
                Correct option: {{ item.answer_position }}
              {% else %}
                Answer not provided.
              {% endif %}
              {% if item.answer_text %}
                â€” {{ item.answer_text }}
              {% endif %}
            </p>
          </details>
        </div>
        {% if item.image_path %}
          <figure>
            <img src="{{ url_for('static', filename=item.image_path) }}" alt="Listening question {{ loop.index }} choice sheet">
          </figure>
        {% endif %}
      </div>
    </div>
  {% endfor %}
{% endblock %}
